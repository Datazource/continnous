{
  "rules": {
    "security": {
      "organizations": {
        "$oid": {
          ".read": "auth.uid != null && auth.token.email != null && root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin'",
          ".write": "auth.uid != null && auth.token.email != null && newData.parent().parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin'",
          "permissions": {
            "$role": {
              ".read": "auth.uid != null && auth.token.email != null && (root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == $role || root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == null && (auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child($role).child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child($role).child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child($role).child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child($role).child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child($role).child('' + 4).val()))))"
            }
          },
          "users": {
            "$uid": {
              ".write": "data.val() == null && (auth.uid != null && auth.token.email != null) && ($uid == auth.uid && newData.val() == '?' || newData.parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin') || data.val() != null && newData.val() != null && (auth.uid != null && auth.token.email != null) && newData.parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin' || data.val() != null && newData.val() == null && (auth.uid != null && auth.token.email != null) && newData.parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin'",
              ".read": "auth.uid != null && auth.token.email != null && ($uid == auth.uid || root.child('security').child('organizations').child($oid).child('permissions').child(root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() != null ? root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin' ? 'member' : root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() : auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 4).val())) ? 'member' : auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 4).val())) ? 'guest' : 'anyone').child('organization').child('read').val() == true || root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin')"
            }
          }
        }
      }
    },
    "flashlight": {
      "paths": {
        "$pid": {
          ".write": "auth.uid != null && auth.token.email != null && (newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('users').child(auth.uid).val() == 'admin' || $pid.contains('-' + newData.child('index').val() + '-' + auth.uid + '-') && newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('permissions').child(newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('users').child(auth.uid).val() != null ? newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('users').child(auth.uid).val() == 'admin' ? 'member' : newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('users').child(auth.uid).val() : auth.token.email.endsWith(('@' + newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('domains').child('member').child('' + 0).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('domains').child('member').child('' + 1).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('domains').child('member').child('' + 2).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('domains').child('member').child('' + 3).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('domains').child('member').child('' + 4).val())) ? 'member' : auth.token.email.endsWith(('@' + newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('domains').child('guest').child('' + 0).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('domains').child('guest').child('' + 1).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('domains').child('guest').child('' + 2).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('domains').child('guest').child('' + 3).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().child('security').child('organizations').child(newData.child('index').val()).child('domains').child('guest').child('' + 4).val())) ? 'guest' : 'anyone').child(newData.child('type').val()).child('read').val() == true)"
        }
      }
    },
    "organizations": {
      "$oid": {
        ".read": "auth.uid != null && auth.token.email != null && (root.child('security').child('organizations').child($oid).child('permissions').child(root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() != null ? root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin' ? 'member' : root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() : auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 4).val())) ? 'member' : auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 4).val())) ? 'guest' : 'anyone').child('organization').child('read').val() == true || root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin')",
        ".write": "auth.uid != null && auth.token.email != null && newData.parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin'",
        "users": {
          "$uid": {
            ".write": "data.val() == null && (auth.uid != null && auth.token.email != null) && $uid == auth.uid || data.val() != null && newData.val() != null && (auth.uid != null && auth.token.email != null) && ($uid == auth.uid || newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin') || data.val() != null && newData.val() == null && (auth.uid != null && auth.token.email != null) && newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin'",
            ".read": "auth.uid != null && auth.token.email != null && ($uid == auth.uid || root.child('security').child('organizations').child($oid).child('permissions').child(root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() != null ? root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin' ? 'member' : root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() : auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 4).val())) ? 'member' : auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 4).val())) ? 'guest' : 'anyone').child('organization').child('read').val() == true || root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin')"
          }
        }
      }
    },
    "$branch": {
      "organizations": {
        "$oid": {
          "$scope": {
            "$type": {
              ".read": "($branch == 'resources' || $branch == 'trash') && (auth.uid != null && auth.token.email != null) && (root.child('security').child('organizations').child($oid).child('permissions').child(root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() != null ? root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin' ? 'member' : root.child('security').child('organizations').child($oid).child('users').child(auth.uid).val() : auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 4).val())) ? 'member' : auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 4).val())) ? 'guest' : 'anyone').child(($scope == 'organization' ? '' : 'personal_') + $type).child('read').val() == true && ($scope == 'organization' || $scope == auth.uid))",
              "$rid": {
                ".write": "($branch == 'resources' || $branch == 'trash') && (auth.uid != null && auth.token.email != null) && (newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('permissions').child(newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() != null ? newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin' ? 'member' : newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() : auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('member').child('' + 0).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('member').child('' + 1).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('member').child('' + 2).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('member').child('' + 3).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('member').child('' + 4).val())) ? 'member' : auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 0).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 1).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 2).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 3).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 4).val())) ? 'guest' : 'anyone').child(($scope == 'organization' ? '' : 'personal_') + $type).child('write').val() == true && ($scope == 'organization' || $scope == auth.uid)) && (data.val() == null || ($scope == 'organization' && data.child('creator').val() == auth.uid || $scope == auth.uid) || newData.val() == null && newData.parent().parent().parent().parent().parent().parent().child('security').child('organizations').child($oid).child('users').child(auth.uid).val() == 'admin')"
              }
            }
          }
        }
      }
    }
  }
}
