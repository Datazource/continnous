{
  "rules": {
    "security": {
      "organizations": {
        "$oid": {
          ".read": "auth.uid != null && auth.token.email != null && root.child('security').child('organizations').child($oid).child('admins').child(auth.uid).val() != null",
          ".write": "auth.uid != null && auth.token.email != null && newData.parent().parent().parent().child('security').child('organizations').child($oid).child('admins').child(auth.uid).val() != null"
        }
      }
    },
    "organizations": {
      "$oid": {
        ".read": "auth.uid != null && auth.token.email != null && (root.child('security').child('organizations').child($oid).child('permissions').child(auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 4).val())) ? 'member' : auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 4).val())) ? 'guest' : 'anyone').child('organization').child('read').val() == true || root.child('security').child('organizations').child($oid).child('admins').child(auth.uid).val() != null)",
        ".write": "auth.uid != null && auth.token.email != null && newData.parent().parent().child('security').child('organizations').child($oid).child('admins').child(auth.uid).val() != null"
      }
    },
    "resources": {
      "$oid": {
        "$type": {
          "$rid": {
            ".read": "auth.uid != null && auth.token.email != null && (root.child('security').child('organizations').child($oid).child('permissions').child(auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('member').child('' + 4).val())) ? 'member' : auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 0).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 1).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 2).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 3).val())) || auth.token.email.endsWith(('@' + root.child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 4).val())) ? 'guest' : 'anyone').child($type).child('read').val() == true || data.child('creator').val() == auth.uid)",
            ".write": "auth.uid != null && auth.token.email != null && (newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('permissions').child(auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('member').child('' + 0).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('member').child('' + 1).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('member').child('' + 2).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('member').child('' + 3).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('member').child('' + 4).val())) ? 'member' : auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 0).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 1).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 2).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 3).val())) || auth.token.email.endsWith(('@' + newData.parent().parent().parent().parent().child('security').child('organizations').child($oid).child('domains').child('guest').child('' + 4).val())) ? 'guest' : 'anyone').child($type).child('write').val() == true || data.child('creator').val() == auth.uid)"
          }
        }
      }
    },
    "users": {
      "$uid": {
        ".read": "auth.uid != null && auth.uid == $uid",
        ".write": "auth.uid != null && auth.uid == $uid"
      }
    }
  }
}
